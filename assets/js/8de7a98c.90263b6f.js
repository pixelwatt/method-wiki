(self.webpackChunkmethod_docs=self.webpackChunkmethod_docs||[]).push([[8336],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return h},kt:function(){return c}});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},h=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,h=l(e,["components","mdxType","originalType","parentName"]),m=d(n),c=o,u=m["".concat(s,".").concat(c)]||m[c]||p[c]||i;return n?a.createElement(u,r(r({ref:t},h),{},{components:n})):a.createElement(u,r({ref:t},h))}));function c(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var d=2;d<i;d++)r[d]=n[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5722:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return l},metadata:function(){return s},toc:function(){return d},default:function(){return p}});var a=n(2122),o=n(9756),i=(n(7294),n(3905)),r=["components"],l={sidebar_position:3},s={unversionedId:"getting-started/template-building",id:"getting-started/template-building",isDocsHomePage:!1,title:"Development Workflow",description:"On this page, I'll brielfy walk you through the different routes for building the frontend components of template files, walk you through an example, and show you how to register template-specific options using CMB2.",source:"@site/docs/getting-started/template-building.md",sourceDirName:"getting-started",slug:"/getting-started/template-building",permalink:"/docs/getting-started/template-building",version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Installation",permalink:"/docs/getting-started/installation"},next:{title:"File Organization",permalink:"/docs/getting-started/file-organization"}},d=[{value:"Building The Frontend",id:"building-the-frontend",children:[{value:"Example 1: The Layout Class Approach",id:"example-1-the-layout-class-approach",children:[]},{value:"Example 2: The Template Approach",id:"example-2-the-template-approach",children:[]}]},{value:"Building The Backend",id:"building-the-backend",children:[{value:"Example 1: The Untemplated Approach",id:"example-1-the-untemplated-approach",children:[]},{value:"Example 2: The Templated Approach",id:"example-2-the-templated-approach",children:[]},{value:"Further Reading",id:"further-reading",children:[]}]},{value:"Theme Options",id:"theme-options",children:[]}],h={toc:d};function p(e){var t=e.components,n=(0,o.Z)(e,r);return(0,i.kt)("wrapper",(0,a.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"On this page, I'll brielfy walk you through the different routes for building the frontend components of template files, walk you through an example, and show you how to register template-specific options using CMB2."),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"building-the-frontend"},"Building The Frontend"),(0,i.kt)("p",null,"When building out template layouts with Method, there are two approaches that you can take: "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"You can build template layouts entirely inside the theme's layout class (which extends Method_Layout), adding logic to the determine_attributes() method to determine which layout components should be included in each template, and then adding the components individually to the build_components() method. Or..."),(0,i.kt)("li",{parentName:"ol"},"You can build template layouts directly inside template files, using methods from Method_Layout to efficiently pull post meta, theme options, and reusable components as needed.")),(0,i.kt)("p",null,"While you can't switch between the two approaches for the same template file, you can handle each template file differently. For example, you could consolidate all of the frontend code for the front page into the layout class, but build the frontend code for the single post template inside the single.php template file. There are advantages to both. Building inside the class is a great way to consolidate code, while building directly inside template files tends to work better for plugin-specific template files (one example being The Events Calendar)."),(0,i.kt)("p",null,"Below, I'll walk you through how you could use both approaches to build the frontend for front-page.php, the front page template for the theme."),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"example-1-the-layout-class-approach"},"Example 1: The Layout Class Approach"),(0,i.kt)("p",null,"First, I'll walk you through how to build the front page template entirely inside the layout class. To start, let's take a look at the ",(0,i.kt)("inlineCode",{parentName:"p"},"front-page.php")," template file itself..."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="front-page.php"',title:'"front-page.php"'},"<?php\n    get_header();\n    $layout = new MethodThemeLayout;\n    echo $layout->build_page( $post->ID );\n    get_footer();\n\n")),(0,i.kt)("p",null,"Because most of the code is consolidated into the MethodThemeLayout (or whatever you decide to call it if using Method Generator), the template file itself is pretty light. We have the standard calls to WordPress' get_header() and get_footer() functions, and in between we create a new ",(0,i.kt)("inlineCode",{parentName:"p"},"MethodThemeLayout")," object, then echo the return of it's public ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/build_page()"},"build_page()")," method, which we pass the post ID to. The ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/build_page()"},"build_page()")," method is inherited form the Method_Layout class, and does a number of different things. This includes determining the post type, determining if the page is using a custom template (or the front page), stores post meta and theme options inside class properties, and assembles the page layout, finally returning the full html for the page."),(0,i.kt)("p",null,"When building inside the layout class, this is pretty much how every template file for a single post will look (aside from extra template information for custom page templates). Now, let's look at the theme layout class, where we'll do most of the work. For the sake of keeping things as short as possible, this class only contains the relevant markup for generating the front page:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="lib/class-theme-layout.php" {18-19,42-69,71-84,92-122}',title:'"lib/class-theme-layout.php"',"{18-19,42-69,71-84,92-122}":!0},"class MethodThemeLayout extends Method_Layout {\n\n    protected function set_opts() {\n        $this->opts = get_option( 'method_options' );\n    }\n\n    protected function determine_attributes() {\n        global $wp_query;\n        if ( true == $this->attr['is_archive'] ) {\n            switch ( $this->attr['post_type'] ) {\n                case 'post':\n                    $this->attr['components'] = array( 'blog-header', 'blog-posts' );\n                    break;\n            }\n        } else {\n            switch ( $this->attr['post_type'] ) {\n                case 'page':\n                    if ( $this->attr['is_front'] ) {\n                        $this->attr['components'] = array( 'front-header', 'page-content' );\n                    } else {\n                        $template = get_page_template_slug( $this->id );\n                        switch ( $template ) {\n                            case 'templates/page-template-custom.php':\n                                $this->attr['components'] = array( 'internal-header', 'page-content' );\n                                break;\n                            default:\n                                $this->attr['components'] = array( 'internal-header', 'page-content' );\n                                break;\n                        }\n                    }\n                    break;\n                case 'post':\n                    $this->attr['components'] = array( 'post-header', 'post-content' );\n                    break;\n                default:\n                    break;\n            }\n        }\n        return;\n    }\n\n    protected function build_header() {\n        $this->scripts .= '\n        ';\n        $this->html .= '\n            <div id=\"grace-primary-nav\">\n                <div class=\"container-fluid ' . method_get_class( 'full_width_container' ) . '\">\n                    <div class=\"row justify-content-center\">\n                        <div class=\"' . method_get_class( 'full_width_outer_col' ) . '\">\n                            <div class=\"navbar-wrap\">\n                                <nav class=\"navbar navbar-expand-lg navbar-light\">\n                                    <a class=\"navbar-brand\" href=\"/\">\n                                        <img src=\"' . get_template_directory_uri() . '/assets/images/logo.svg\" class=\"img-fluid\" id=\"site-logo\" width=\"178\" height=\"79\" alt=\"Method logo\">\n                                    </a>\n                                    <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbarSupportedContent\" aria-controls=\"navbarSupportedContent\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n                                        <span class=\"navbar-toggler-icon\"></span>\n                                    </button>\n                                    <div class=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\n                                        ' . wp_nav_menu( array( 'theme_location' => 'primary', 'depth' => 2, 'container' => '', 'menu_class' => '', 'items_wrap' => '<ul id=\"%1$s\" class=\"navbar-nav ms-auto %2$s\">%3$s</ul>','walker' => new bootstrap_5_wp_nav_menu_walker(), 'fallback_cb' => '__return_false', 'echo' => false, ) ) . '\n                                    </div>\n                                </nav>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        ';\n        return;\n    }\n\n    protected function build_footer() {\n        $this->html .= '\n            <footer>\n                <div class=\"container-fluid ' . method_get_class( 'full_width_container' ) . '\">\n                    <div class=\"row justify-content-center\">\n                        <div class=\"' . method_get_class( 'full_width_outer_col' ) . '\">\n                            ' . ( $this->get_option( 'footer_copyright' ) ? '<p id=\"copyright\">' . esc_html( $this->get_option( 'footer_copyright' ) ) . '</p>' : '' ) . '\n                        </div>\n                    </div>\n                </div>\n            </footer>\n        ';\n        return;\n    }\n\n    protected function build_components() {\n        if ( true == $this->attr['is_archive'] ) {\n            global $wp_query;\n        }\n        foreach ( $this->attr['components'] as $component ) {\n            switch ( $component ) {\n                case 'front-header':\n                    $this->html .= '\n                        <div id=\"method-front-header\">\n                            <div class=\"container-fluid ' . method_get_class( 'full_width_container' ) . '\">\n                                <div class=\"row justify-content-center\">\n                                    <div class=\"' . method_get_class( 'full_width_outer_col' ) . '\">\n                                        <div class=\"d-flex align-items-center justify-content-start\">\n                                            <div class=\"headline-wrap\">\n                                                ' . $this->get_headline( '_method_header_headline', '<h1>', '</h1>', 'Welcome to My Site!' ) . '\n                                                ' . ( $this->get_meta( '_method_header_subtitle' ) ? '<span class=\"subtitle\">' . esc_html( $this->get_meta( '_method_header_subtitle' ) ) . '</span>' : '' ) . '\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    ';\n                    break;\n                case 'page-content':\n                    $this->html .= '\n                        <div id=\"method-front-content\">\n                            <div class=\"container-fluid ' . method_get_class( 'full_width_container' ) . '\">\n                                <div class=\"row justify-content-center\">\n                                    <div class=\"' . method_get_class( 'full_width_outer_col' ) . '\">\n                                        ' . $this->filter_content( get_the_content( null, false, $this->id ) ) . '\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    ';\n                    break;\n                default:\n                    break;\n            }\n        }\n        return;\n    }\n\n}\n\n")),(0,i.kt)("p",null,"In the above layout class, we're doing all the actual work for building out the front page. I've highlighted the relevant portions of code. "),(0,i.kt)("p",null,"First, in the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/determine_attributes()"},"determine_attributes()")," method, we specify which components should be built if the current post is the static front page (lines 18-19). "),(0,i.kt)("p",null,"We provide the actual markup for these components further down in the class, in the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/build_components()"},"build_components()")," method. Here, we query and format post meta using the inherited ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/get_meta()"},"get_meta()")," and ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/get_headline()"},"get_headline()")," methods. Because the class stores all post meta for reuse across the layout, there's no need to use get_post_meta(). The same goes for WordPress' get_option() function. Instead, we use the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/get_option()"},"get_option()")," method to query stored data. By reusing this data across components, the number of database queries generated by our page can be greatly reduced."),(0,i.kt)("p",null,"Finally, the code for the header and footer are contained in the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/build_header()"},"build_header()")," and ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/build_header()"},"build_footer()")," methods. These methods are automatically called when using the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/build_page()"},"build_page()")," method, reguardless of the template being built."),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"example-2-the-template-approach"},"Example 2: The Template Approach"),(0,i.kt)("p",null,"Now that you've seen how to build a template using the layout class, lets build the same layout using the template approach. If we decided to build the front-page.php layout directly inside the template, it would look something like this..."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="front-page.php"',title:'"front-page.php"'},"<?php\n    get_header();\n    $layout = new MethodThemeLayout;\n    $layout->init_page( $post->ID );\n    echo $layout->get_header_markup();\n?>\n    \x3c!-- start header --\x3e\n    <div id=\"method-front-header\">\n        <div class=\"container-fluid <?php echo method_get_class( 'full_width_container' ); ?>\">\n            <div class=\"row justify-content-center\">\n                <div class=\"<?php echo method_get_class( 'full_width_outer_col' ); ?>\">\n                    <div class=\"d-flex align-items-center justify-content-start\">\n                        <div class=\"headline-wrap\">\n                            <?php\n                                echo $layout->get_headline( '_method_header_headline', '<h1>', '</h1>', 'Welcome to My Site!' );\n                                echo ( $layout->get_meta( '_method_header_subtitle' ) ? '<span class=\"subtitle\">' . esc_html( $layout->get_meta( '_method_header_subtitle' ) ) . '</span>' : '' );\n                            ?>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    \x3c!-- end header --\x3e\n<?php\n    echo $layout->get_component( 'page-content' );\n    echo $layout->get_footer_markup();\n    get_footer();\n?>\n")),(0,i.kt)("p",null,"In the code above, we start out by creating a new MethodThemeLayout object just as before, but instead of calling the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/build_page()"},"build_page()")," method on line 4, we instead call ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/init_page()"},"init_page()"),". This method does a lot of the same setup work that the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/build_page()"},"build_page()")," method does, but doesn't build or return anything. Instead, it leaves it to us to build the template out."),(0,i.kt)("p",null,"To begin building the page out, we start by echoing the return of the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/get_header_markup()"},"get_header_markup()")," method. This method essentially returns anything added to the class ",(0,i.kt)("inlineCode",{parentName:"p"},"$html")," property by the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/build_header()"},"build_header()")," method we saw earlier in the class example."),(0,i.kt)("p",null,"If we added any markup to the ",(0,i.kt)("inlineCode",{parentName:"p"},"$scripts")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"$modals")," properties in the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/build_header()"},"build_header()")," method, that markup would be returned with the call to the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/get_footer_markup()"},"get_footer_markup()")," method on line 28 to preserve code order on the page (unless the $standalone argument was passed as ",(0,i.kt)("em",{parentName:"p"},"true")," to ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/init_page()"},"init_page()"),", which should only be done if you do not intend to call the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/get_footer_markup()"},"get_footer_markup()")," method)."),(0,i.kt)("p",null,"Next, we build the header in much the same way we did in the class example. We have access to the same method and functions as we did inside the class for accessing post meta, so aside from adding echoes and changing some names around, we're good to go."),(0,i.kt)("p",null,"Next, we call the get_component() method to get the output of the ",(0,i.kt)("inlineCode",{parentName:"p"},"page-content")," compontent we added in the class example. Because this component appears on multiple templates, we keep it inside the layout class so we can reuse it without repeating ourselves. As with get_header_markup(), only content added to the $html property by a requested component will be returned. Anything markup added to $scripts and $modals will be returned with get_footer_markup() (unless $standalone was passed to init_page() as true, in which case markup added to all 3 properties would be returned)."),(0,i.kt)("p",null,"Finally, we echo the return of the get_footer_markup() method, which in this case will return all content added to the ",(0,i.kt)("inlineCode",{parentName:"p"},"$html")," class property by the build_footer() method, as well as the content added to ",(0,i.kt)("inlineCode",{parentName:"p"},"$scripts")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"$modals")," by build_header(), build_footer(), and any components we added using the get_component() method."),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"building-the-backend"},"Building The Backend"),(0,i.kt)("p",null,"Now that we've gone over how to build the frontend for our templates, let's take a moment to look at the backend. In the examples above, we referenced two meta keys, ",(0,i.kt)("inlineCode",{parentName:"p"},"_method_front_headline")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"_method_front_subtitle"),". In this section, we'll go through how to provide custom editor options to control the content stored in these meta keys."),(0,i.kt)("p",null,"For the examples below, we'll be working with two files: ",(0,i.kt)("inlineCode",{parentName:"p"},"lib/cmb2-metaboxes.php")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"lib/cmb2-options-loader.php"),". In ",(0,i.kt)("inlineCode",{parentName:"p"},"lib/cmb2-metaboxes.php"),", we'll register our metaboxes. To assist in registering individual options, we can optionally use the method_load_cmb2_options() function in ",(0,i.kt)("inlineCode",{parentName:"p"},"lib/cmb2-options-loader.php")," to template out sets of options, if our theme's design contains components shared across multiple layouts."),(0,i.kt)("p",null,"While we won't be working inside the file, it's worth mentioning ",(0,i.kt)("inlineCode",{parentName:"p"},"lib/cmb2-helper-functions.php"),", which adds visibility options for targeting the front page template editor and default page template editor."),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"example-1-the-untemplated-approach"},"Example 1: The Untemplated Approach"),(0,i.kt)("p",null,"For this example, we'll create a metabox that only appears in the page editor when editing the front page of the site. Instead of templating options via the method_load_cmb2_options() function, we'll stick to the default way of registering options."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="lib/cmb2-metaboxes.php"',title:'"lib/cmb2-metaboxes.php"'},"<?php\n\n//======================================================================\n// CMB2 METABOXES\n//======================================================================\n\n/**\n * Front Page Metabox\n */\n\nadd_action( 'cmb2_admin_init', 'method_register_page_front_metabox' );\n\nfunction method_register_page_front_metabox() {\n    $prefix = '_method_';\n\n    $cmb_options = new_cmb2_box(\n        array(\n            'id'            => $prefix . 'metabox_page_front',\n            'title'         => esc_html__( 'Front Page Options', 'cmb2' ),\n            'object_types'  => array( 'page' ),\n            'show_on' => array(\n                'key' => 'front-page',\n                'value' => '',\n            ),\n        )\n    );\n\n    $cmb_options->add_field(\n        array(\n            'name'     => __( '<span style=\"font-size: 1.5rem; font-weight: 900;\">Header Options</span>', 'method' ),\n            'id'       => $prefix . 'header_info',\n            'type'     => 'title',\n        )\n    );\n    $cmb_options->add_field(\n        array(\n            'name'     => __( 'Headline', 'method' ),\n            'desc'     => __( method_get_tags_badge() . 'Provide a headline for the page header.', 'method' ),\n            'id'       => $prefix . 'header_headline',\n            'type'     => 'text',\n        )\n    );\n    $cmb_options->add_field(\n        array(\n            'name'     => __( 'Subtitle', 'method' ),\n            'desc'     => __( 'Additionally, provide a subtitle for the page header.', 'method' ),\n            'id'       => $prefix . 'header_subtitle',\n            'type'     => 'text',\n        )\n    );\n}\n\n")),(0,i.kt)("p",null,"In the code above, we use the ",(0,i.kt)("inlineCode",{parentName:"p"},"method_register_page_front_metabox()")," function to register a new CMB2 metabox, only to be shown when editing the static front page. Once we've created the new metabox object, we use CMB2's ",(0,i.kt)("inlineCode",{parentName:"p"},"add_field()")," method to register options for a section heading, headline text input, and subtitle text input. If you're familiar with CMB2, there isn't much else to see. This is the standard approach to registering metaboxes with the framework."),(0,i.kt)("p",null,"The only item of note is the call to a function called ",(0,i.kt)("inlineCode",{parentName:"p"},"method_get_tags_badge()")," on line 38. To allow for safe use of limited HTML formatting inside text inputs, Method utilizes shortcode-like ",(0,i.kt)("a",{parentName:"p",href:"/docs/other-references/format-tags"},"format tags"),", and provides methods to process them. When registering a field that you intend to allow use of format tags in, you can use ",(0,i.kt)("inlineCode",{parentName:"p"},"method_get_tags_badge()")," to add a badge into that field's description letting content editors know that it's safe to use format tags. Clicking on the badge will open an overlay that details supported tags and provides examples of supported input. Because the ",(0,i.kt)("a",{parentName:"p",href:"/docs/method-layout/methods/get_headline()"},"get_headline()")," method used in the examples about automatically processes format tags, we've added a badge to the description for the headline field."),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"example-2-the-templated-approach"},"Example 2: The Templated Approach"),(0,i.kt)("p",null,"In the first example, we registered a metabox with custom options to control the headline and subtitle for the header that appears on the static front page of our site. The code we used works great if the front page of the site is the only one with a header, but what if a similiar header was used on multiple templates? We could replicate the fields we added using CMB2's ",(0,i.kt)("inlineCode",{parentName:"p"},"add_field()")," method for every metabox registration, but that's a lot of repeated code. In the example below, I'll walk you through how to template options using Method's ",(0,i.kt)("inlineCode",{parentName:"p"},"method_register_page_front_metabox()")," function. Let's start by making a change to the metabox we created in the first example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="lib/cmb2-metaboxes.php" {28}',title:'"lib/cmb2-metaboxes.php"',"{28}":!0},"<?php\n\n//======================================================================\n// CMB2 METABOXES\n//======================================================================\n\n/**\n * Front Page Metabox\n */\n\nadd_action( 'cmb2_admin_init', 'method_register_page_front_metabox' );\n\nfunction method_register_page_front_metabox() {\n    $prefix = '_method_';\n\n    $cmb_options = new_cmb2_box(\n        array(\n            'id'            => $prefix . 'metabox_page_front',\n            'title'         => esc_html__( 'Front Page Options', 'cmb2' ),\n            'object_types'  => array( 'page' ),\n            'show_on' => array(\n                'key' => 'front-page',\n                'value' => '',\n            ),\n        )\n    );\n\n    method_load_cmb2_options( $cmb_options, array( 'header-options' ) );\n\n}\n\n")),(0,i.kt)("p",null,"In the code above, we've replace the metabox's field registrations with a call to ",(0,i.kt)("inlineCode",{parentName:"p"},"method_load_cmb2_options()"),". This function accepts two arguments. For the first argument, we provide the CMB2 object that we want to add templated options to. For the second option, we pass an array of option sets that we want to add. In this case, we're only adding one set of options, those being ",(0,i.kt)("inlineCode",{parentName:"p"},"'header-options'"),"."),(0,i.kt)("p",null,"Now lets take a look at the ",(0,i.kt)("inlineCode",{parentName:"p"},"lib/cmb2-options-loader.php")," file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="lib/cmb2-options-loader.php" {11-35}',title:'"lib/cmb2-options-loader.php"',"{11-35}":!0},"<?php\n\n//======================================================================\n// CMB2 OPTIONS LOADER\n//======================================================================\n\nfunction method_load_cmb2_options( &$obj, $temps ) {\n    foreach ( $temps as $temp ) {\n        $prefix = str_replace( '-', '_', $temp );\n        switch ( $temp ) {\n            case 'header-options':\n                $obj->add_field(\n                    array(\n                        'name'     => __( '<span style=\"font-size: 1.5rem; font-weight: 900;\">Header Options</span>', 'method' ),\n                        'id'       => '_method_header_info',\n                        'type'     => 'title',\n                    )\n                );\n                $obj->add_field(\n                    array(\n                        'name'     => __( 'Headline', 'method' ),\n                        'desc'     => __( method_get_tags_badge() . 'Provide a headline for the page header.', 'method' ),\n                        'id'       => '_method_header_headline',\n                        'type'     => 'text',\n                    )\n                );\n                $obj->add_field(\n                    array(\n                        'name'     => __( 'Subtitle', 'method' ),\n                        'desc'     => __( 'Additionally, provide a subtitle for the page header.', 'method' ),\n                        'id'       => '_method_header_subtitle',\n                        'type'     => 'text',\n                    )\n                );\n                break;\n            default:\n                break;\n        }\n    }\n    return;\n}\n\n")),(0,i.kt)("p",null,"In the code above, we've added a case to ",(0,i.kt)("inlineCode",{parentName:"p"},"method_load_cmb2_options()"),"'s switch statement for the ",(0,i.kt)("inlineCode",{parentName:"p"},"header-options")," fieldset. Overall, the code for the field registrations is pretty similiar to the ones from the first example. The only differences are that we're adding the fields to ",(0,i.kt)("inlineCode",{parentName:"p"},"$obj")," instead of ",(0,i.kt)("inlineCode",{parentName:"p"},"$cmb2_options"),", and we're hardcoding the entire metakey for each option (the ",(0,i.kt)("inlineCode",{parentName:"p"},"id")," key), since we didn't pass ",(0,i.kt)("inlineCode",{parentName:"p"},"$prefix")," to the function."),(0,i.kt)("hr",null),(0,i.kt)("h3",{id:"further-reading"},"Further Reading"),(0,i.kt)("p",null,"For more information on using CMB2, check out the plugin's ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/CMB2/CMB2/wiki"},"extensive wiki"),"."),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"theme-options"},"Theme Options"),(0,i.kt)("p",null,"In addition to being used for custom metaboxes across our theme, CMB2 is also used to create the theme's custom options page. All code responsible for creating the options page and registering it's fields can be found in the ",(0,i.kt)("inlineCode",{parentName:"p"},"lib/theme-customization.php")," file. Overall, the code is very similar to that used for creating metaboxes. The main difference is that field IDs are stored as keys inside the ",(0,i.kt)("inlineCode",{parentName:"p"},"method_options")," option in the ",(0,i.kt)("inlineCode",{parentName:"p"},"wp_options")," table, instead of individual meta keys."))}p.isMDXComponent=!0}}]);